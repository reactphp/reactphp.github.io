<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <title>ChildProcess: 
ChildProcess - ReactPHP</title>

        <meta name="description" content="Event-driven library for executing child processes with ReactPHP.">

        <link rel="apple-touch-icon" sizes="180x180" href="https://reactphp.org/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://reactphp.org/favicon-32x32.png">
        <link rel="manifest" href="https://reactphp.org/manifest.json">
        <link rel="mask-icon" href="https://reactphp.org/safari-pinned-tab.svg" color="#4f5b93">
        <meta name="apple-mobile-web-app-title" content="ReactPHP">
        <meta name="application-name" content="ReactPHP">
        <meta name="theme-color" content="#f4f3f1">
        <meta name="msapplication-config" content="https://reactphp.org/browserconfig.xml" />

        <meta property="og:image" content="https://reactphp.org/og-image.png">

            <link rel="preload" href="../assets/sourcesanspro-regular.19ca4d35.woff" as="font" type="font/woff" crossorigin>
        <link rel="preload" href="../assets/sourcesanspro-bold.be4ba3dd.woff" as="font" type="font/woff" crossorigin>

        <script>window.__assets = '../assets/';</script>
        <script>!function(e){function t(t){for(var n,o,i=t[0],c=t[1],l=t[2],f=0,d=[];f<i.length;f++)o=i[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(s&&s(t);d.length;)d.shift()();return u.push.apply(u,l||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var r=u[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(u.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={1:0},a={1:0},u=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[];o[e]?t.push(o[e]):0!==o[e]&&{3:1,4:1,5:1}[e]&&t.push(o[e]=new Promise((function(t,r){for(var n=({}[e]||e)+"."+{2:"31d6cfe0",3:"284c81ab",4:"87863994",5:"ef18ddd4"}[e]+".css",a=i.p+n,u=document.getElementsByTagName("link"),c=0;c<u.length;c++){var l=(s=u[c]).getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(l===n||l===a))return t()}var f=document.getElementsByTagName("style");for(c=0;c<f.length;c++){var s;if((l=(s=f[c]).getAttribute("data-href"))===n||l===a)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var n=t&&t.target&&t.target.src||a,u=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");u.code="CSS_CHUNK_LOAD_FAILED",u.request=n,delete o[e],d.parentNode.removeChild(d),r(u)},d.href=a,document.getElementsByTagName("head")[0].appendChild(d)})).then((function(){o[e]=0})));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=n);var u,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=function(e){return i.p+""+({}[e]||e)+"."+{2:"0f8f4948",3:"ca2827c9",4:"7d534a7e",5:"99f8f23a"}[e]+".js"}(e);var l=new Error;u=function(t){c.onerror=c.onload=null,clearTimeout(f);var r=a[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",l.name="ChunkLoadError",l.type=n,l.request=o,r[1](l)}a[e]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:c})}),12e4);c.onerror=c.onload=u,document.head.appendChild(c)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var f=0;f<c.length;f++)t(c[f]);var s=l;r()}([]);</script>
        <style>@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:local("Source Sans Pro Regular"),local("SourceSansPro-Regular"),url(../assets/sourcesanspro-regular.19ca4d35.woff) format("woff")}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:700;font-display:swap;src:local("Source Sans Pro Bold"),local("SourceSansPro-Bold"),url(../assets/sourcesanspro-bold.be4ba3dd.woff) format("woff")}@font-face{font-family:icons;src:url(../assets/icons.063d0ba7.ttf) format("truetype"),url(../assets/icons.5ea4cc5c.woff) format("woff"),url(../assets/icons.d59afb7d.svg#icons) format("svg");font-weight:400;font-style:normal}[class*=" icon-"],[class^=icon-]{font-family:icons!important;speak:none;font-style:normal;font-weight:400;-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-hash:before{content:"\e900"}.icon-twitter:before{content:"\e901"}.icon-github:before{content:"\e902"}.icon-blog:before{content:"\e905"}.icon-earth:before{content:"\e903"}.icon-link:before{content:"\e906"}.icon-youtube:before{content:"\e904"}.icon-book:before{content:"\f007"}.icon-calendar:before{content:"\f068"}.icon-chevron-down:before{content:"\f0a3"}.icon-chevron-up:before{content:"\f0a2"}.icon-law:before{content:"\f0d8"}.icon-search:before{content:"\f02e"}.icon-x:before{content:"\f081"}.icon-feed:before{content:"\ea9b"}[class*=" icon-"],[class^=icon-]{vertical-align:-8%}html{-webkit-box-sizing:border-box;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;font-size:16px;line-height:1.6}@media (max-width:768px){html{font-size:18px}}*,:after,:before{-webkit-box-sizing:inherit;box-sizing:inherit}body{margin:0;color:#584b4f;color:var(--color-base);background-color:#fff}a{color:#4f5b93;color:var(--color-key)}a:hover{color:#a2aacd;color:var(--color-key-light);text-decoration:underline}blockquote{padding:16px 16px 16px 24px;border-left:4px solid #4f5b93;border-left:4px solid var(--color-key);border-radius:4px;background-color:#f4f3f1;background-color:var(--color-background-lighter);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter);position:relative;font-size:.875rem}blockquote:before{content:"i";position:absolute;top:12px;left:-14px;display:block;width:24px;height:24px;background:#4f5b93;background:var(--color-key);font-size:12px;padding:0 4px;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:center;font-weight:700;color:#fff;line-height:24px;border-radius:50%}blockquote :last-child{margin-bottom:0}blockquote,fieldset,form,h1,h2,h3,h4,h5,h6,hr,ol,p,ul{margin:0 0 16px}ul ul{margin-bottom:0}hr{clear:both;height:0;border:0;border-bottom:1px dashed #eae8e3;border-bottom:1px dashed var(--color-background-light);padding:0}h1,h2,h3,h4,h5,h6{line-height:1;-webkit-font-smoothing:antialiased;color:#584b4f;color:var(--color-base);font-family:Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-weight:700}h1 a,h1 a:hover,h2 a,h2 a:hover,h3 a,h3 a:hover,h4 a,h4 a:hover,h5 a,h5 a:hover,h6 a,h6 a:hover{text-decoration:none}h1{font-size:2.5rem;margin-bottom:32px;letter-spacing:-1px}h1,h1 a,h1 a:hover{color:#4f5b93;color:var(--color-key)}h1:not(:first-child){margin-top:32px}h2{font-size:2rem;margin-bottom:32px}h2,h2 a,h2 a:hover{color:#4f5b93;color:var(--color-key)}h2:not(:first-child){margin-top:32px}h3{font-size:1.5rem;margin-bottom:24px}h3,h3 a,h3 a:hover{color:#584b4f;color:var(--color-base)}h3:not(:first-child){margin-top:24px}h4{font-size:1.25rem}h4,h4 a,h4 a:hover{color:#4f5b93;color:var(--color-key)}h4:not(:first-child){margin-top:24px}@media (max-width:768px){h1{font-size:2rem}h2{font-size:1.75rem;margin-bottom:32px}}.container{padding:32px}@media (max-width:768px){.container{padding:16px}}.wrapper{max-width:1600px;margin:auto}.wrapper--medium{max-width:1280px}.wrapper--small{max-width:960px;margin:auto}.wrapper--narrow{max-width:640px}.main{width:calc(98% - 400px)}.main,.sidebar{margin-bottom:32px}.sidebar{width:calc(400px - 2%)}@media (max-width:1024px){.main,.sidebar{width:auto;margin-top:16px}}.visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px)}.grid{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:center;justify-content:center;width:102%;margin-left:-2%}.grid>*{margin-left:2%;max-width:100%}.grid--4cols>*{-ms-flex-preferred-size:23%;flex-basis:23%}.grid--3cols>*{-ms-flex-preferred-size:31.33%;flex-basis:31.33%}.grid--2cols>*{-ms-flex-preferred-size:48%;flex-basis:48%}@media (max-width:768px){.grid{-ms-flex-direction:column;flex-direction:column}.grid,.grid>*{width:100%;margin-left:0}.grid>*{-ms-flex:0 0 auto;flex:0 0 auto}}.center{text-align:center}.center h1,.center h2,.center h3,.center h4,.center h5,.center h6,.hamburger{display:inline-block}.hamburger{padding:14px 12px;height:48px;cursor:pointer;font:inherit;color:inherit;text-transform:none;background-color:transparent;border:0;margin:0;overflow:visible;outline:none}.hamburger__box{width:24px;height:16px;display:inline-block;position:relative}.hamburger__inner{display:block;top:50%;margin-top:-2px}.hamburger__inner,.hamburger__inner:after,.hamburger__inner:before{width:24px;height:3px;background-color:#584b4f;background-color:var(--color-base);border-radius:2px;position:absolute;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;-o-transition-property:transform;transition-property:transform;transition-property:transform,-webkit-transform;-webkit-transition-duration:.15s;-o-transition-duration:.15s;transition-duration:.15s;-webkit-transition-timing-function:ease;-o-transition-timing-function:ease;transition-timing-function:ease}.hamburger__inner:after,.hamburger__inner:before{content:"";display:block}.hamburger__inner:before{top:-6px}.hamburger__inner:after{bottom:-6px}.header{width:100%;background:#fefefe;-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.08);box-shadow:0 1px 0 0 rgba(0,0,0,.08);-webkit-box-shadow:var(--box-shadow-lightest);box-shadow:var(--box-shadow-lightest);padding:0 32px}@media (max-width:768px){.header{padding:0 16px}}.header__container{width:100%;position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between}.header__logo{display:block;line-height:1;padding:16px 0}.header__logo svg{display:block;width:120px;height:18px}.header__search{margin:0;position:absolute;right:48px;top:7px;z-index:799}.header__search input{width:400px}@media (max-width:768px){.header__search input{width:calc(100vw - 94px)}}.header__menu{position:absolute;right:-12px;top:0;z-index:800}.footer{background:#584b4f;background:var(--color-base);padding:32px;text-align:center;text-shadow:1px 1px 0 rgba(0,0,0,.125)}.footer .links a{color:#eae8e3;color:var(--color-background-light);text-decoration:none}.footer .links a:hover{color:#9ad8bb;color:var(--color-green-light);text-decoration:none}.iframe{position:relative;padding-bottom:56.25%;height:0;overflow:hidden;width:100%}.iframe iframe{position:absolute;top:0;left:0;width:100%;height:100%}.links{margin:0;padding:0}.links li{display:inline-block;margin:0 8px;text-decoration:none}.links li:first-child{margin-left:0}.links li:last-child{margin-right:0}.links a{display:block}.box,.links a,.links a:hover{text-decoration:none}.box{background:#f4f3f1;background:var(--color-background-lighter);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter);border-radius:4px;text-align:left;vertical-align:top;padding:24px;margin-top:0;margin-bottom:24px;color:inherit;overflow:auto;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.box:hover{background:#eae8e3;background:var(--color-background-light);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.15);box-shadow:0 1px 0 0 rgba(0,0,0,.15);-webkit-box-shadow:var(--box-shadow-light);box-shadow:var(--box-shadow-light);text-decoration:none}.box h1,.box h2,.box h3,.box h4,.box h5,.box h6,.box hr,.box ol,.box p,.box ul{margin-bottom:8px}.box h1,.box h2,.box h3,.box h4,.box h5,.box h6{color:#584b4f;color:var(--color-base)}.box :first-child{margin-top:0}.box :last-child{margin-bottom:0}.box__content{-ms-flex-positive:1;flex-grow:1;color:#584b4f;color:var(--color-base);text-decoration:none}.box__content p{font-size:.875rem}.box__content:hover{color:#584b4f;color:var(--color-base);text-decoration:none}.box__content:not(:last-child){margin-bottom:16px}.box__link{display:block;font-size:.75rem;text-decoration:none}.box__link,.box__link [class*=icon]{color:#4f5b93;color:var(--color-key)}.box__link:hover{color:#a2aacd;color:var(--color-key-light);text-decoration:none}code,pre,tt{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace}code,tt{font-size:.75rem;padding:.3rem .45rem;margin:0;background-color:rgba(0,0,0,.05);border-radius:4px}code br,tt br{display:none}del code{text-decoration:inherit}pre{word-wrap:normal;text-align:left;font-size:.875rem;line-height:1.45}@media (max-width:768px){pre{font-size:.75rem}}pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.highlight{margin-bottom:16px}.highlight pre{margin-bottom:0;word-break:normal}.highlight pre,pre{padding:16px 16px 14px;overflow:auto;background-color:#f9f9f8;background-color:var(--color-background-lightest);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.08);box-shadow:0 1px 0 0 rgba(0,0,0,.08);-webkit-box-shadow:var(--box-shadow-lightest);box-shadow:var(--box-shadow-lightest);color:#584b4f;color:var(--color-base);text-shadow:none!important;border-radius:4px}pre code,pre tt{display:inline;max-width:none;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}pre code:after,pre code:before,pre tt:after,pre tt:before{content:normal}.pl-c{color:#969896}.pl-c1,.pl-s .pl-v{color:#0086b3}.pl-e,.pl-en{color:#795da3}.pl-s .pl-s1,.pl-smi{color:#444}.pl-ent{color:#63a35c}.pl-k{color:#a71d5d}.pl-pds,.pl-s,.pl-s .pl-pse .pl-s1,.pl-sr,.pl-sr .pl-cce,.pl-sr .pl-sra,.pl-sr .pl-sre{color:#183691}.pl-smw,.pl-v{color:#ed6a43}.pl-bu{color:#b52a1d}.pl-c2,.pl-ii{color:#f8f8f8;background-color:#b52a1d}.pl-c2:before{content:"^M"}.pl-sr .pl-cce{font-weight:700;color:#63a35c}.pl-ml{color:#693a17}.pl-mh,.pl-mh .pl-en,.pl-ms{font-weight:700;color:#1d3e81}.pl-mq{color:teal}.pl-mi{font-style:italic;color:#333}.pl-mb{font-weight:700;color:#333}.pl-md{color:#bd2c00;background-color:#ffecec}.pl-mi1{color:#55a532;background-color:#eaffea}.pl-mc{color:#ef9700;background-color:#ffe3b4}.pl-mi2{color:#d8d8d8;background-color:grey}.pl-mdr{font-weight:700;color:#795da3}.pl-mo{color:#1d3e81}.pl-ba{color:#595e62}.pl-sg{color:silver}.pl-corl{text-decoration:underline;color:#183691}.anchor{display:block;float:left;position:absolute;padding-right:2px;-webkit-transform:translateX(-100%);transform:translateX(-100%);text-decoration:none!important}.anchor:focus{outline:none}.anchor>*{visibility:hidden}:hover>.anchor>*{visibility:visible}.anchor>:before{content:"#";font-weight:400!important;color:#a2aacd;color:var(--color-key-light)}.anchor--disable .anchor>*,.anchor.anchor--disable>*{visibility:hidden!important}.searchbox{width:100%}.searchbox,.searchbox:focus{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:6px 8px 6px 32px;font-size:.875rem;line-height:24px;color:#584b4f;color:var(--color-base);border:0;background:#eae8e3 url(../assets/search.72dc4739.svg) no-repeat 10px;background:var(--color-background-light) url(../assets/search.72dc4739.svg) no-repeat 10px;background-size:16px 16px;-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.15);box-shadow:0 1px 0 0 rgba(0,0,0,.15);-webkit-box-shadow:var(--box-shadow-light);box-shadow:var(--box-shadow-light);border-radius:4px;outline:none;-webkit-transition:width .35s cubic-bezier(.23,1,.32,1);-o-transition:width .35s cubic-bezier(.23,1,.32,1);transition:width .35s cubic-bezier(.23,1,.32,1)}.searchbox::-webkit-input-placeholder{color:#afa1a5;color:var(--color-base-light)}.searchbox:-moz-placeholder,.searchbox::-moz-placeholder{color:#afa1a5;color:var(--color-base-light)}.searchbox::-moz-placeholder{opacity:1}.searchbox:-ms-input-placeholder{color:#afa1a5;color:var(--color-base-light)}.searchbox:focus{background-color:#f4f3f1!important;background-color:var(--color-background-lighter)!important;-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter)}.searchbox--collapsed:not(:focus){background-color:transparent;border:0;width:32px!important;margin-right:-12px;cursor:pointer;-webkit-box-shadow:none;box-shadow:none}.searchbox--collapsed:not(:focus)::-webkit-search-cancel-button,.searchbox--collapsed:not(:focus)::-webkit-search-decoration{display:none}.searchbox--collapsed:not(:focus)::-webkit-search-results-button,.searchbox--collapsed:not(:focus)::-webkit-search-results-decoration{display:none}.searchbox--collapsed:not(:focus)::-ms-clear{display:none}.searchbox--large,.searchbox--large:focus{padding:8px 12px 8px 40px}.alert{padding:16px 16px 16px 24px;border-left:4px solid #ba3525;border-left:4px solid var(--color-red);border-radius:4px;background-color:#f4f3f1;background-color:var(--color-background-lighter);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter);position:relative;font-size:.9em}.alert:before{content:"!";position:absolute;top:12px;left:-14px;display:block;width:24px;height:24px;background:#ba3525;background:var(--color-red);font-size:12px;padding:0 4px;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:center;font-weight:700;color:#fff;line-height:22px;border-radius:50%}.alert a{color:#ba3525;color:var(--color-red)}.alert :last-child{margin-bottom:0}.toc{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0;list-style:none;margin-left:-4px}.toc li{margin:4px}.toc a{display:-ms-flexbox;display:flex;background-color:#584b4f;background-color:var(--color-base);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter);font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-weight:bolder;letter-spacing:normal;padding:.25rem 1rem .15rem;border-radius:4px}.toc a,.toc a:hover{color:#fff;text-decoration:none}@media (max-width:768px){.toc{font-size:.85rem}}.welcome__intro{padding:16px 0 136px;border-bottom:1px dashed #eae8e3;border-bottom:1px dashed var(--color-background-light);background-image:-o-radial-gradient(center,ellipse,#fff 0,#eae8e3 100%);background-image:radial-gradient(ellipse at center,#fff 0,#eae8e3 100%);background-image:-o-radial-gradient(center,ellipse,#fff 0,var(--color-background-light) 100%);background-image:radial-gradient(ellipse at center,#fff 0,var(--color-background-light) 100%);background-size:auto 100%;background-position:50% 0}.welcome__intro h1{font-size:2rem;margin-bottom:16px;color:#4f5b93;color:var(--color-key)}.welcome__logo{display:block;margin:0 auto;max-width:320px}.welcome__logo svg{display:block;height:240px}.welcome__content{padding-top:16px;display:block;max-width:calc(98% - 320px)}.welcome__example{display:block;max-width:850px;margin:-160px auto auto}.welcome__example .highlight pre{padding:32px;background:#fff;-webkit-box-shadow:0 0 16px #d6d1c8;box-shadow:0 0 16px #d6d1c8;-webkit-box-shadow:0 0 16px var(--color-background);box-shadow:0 0 16px var(--color-background)}.welcome__intro .links a{color:#584b4f;color:var(--color-base);text-decoration:none}.welcome__intro .links a:hover{color:#4f5b93;color:var(--color-key);text-decoration:none}.welcome__team img{border-radius:50%;max-width:190px;display:inline-block}.welcome__team h3{display:block;margin:.2em 0}.welcome__team div.grid>*{margin-bottom:1em}@media (max-width:768px){.welcome__content{padding:32px 16px 16px;max-width:100%}.welcome__logo svg{height:160px}.welcome__intro h1{text-align:center;font-size:1.75rem;margin-bottom:16px;color:#4f5b93;color:var(--color-key)}.welcome__intro .links{text-align:center}}.off-canvas-menu{position:fixed;top:0;right:0;pointer-events:none}.off-canvas-menu__content{-webkit-transform:translate3d(105%,0,0);transform:translate3d(105%,0,0)}.component-info{position:-webkit-sticky;position:sticky;top:16px;bottom:16px;padding:24px;background-color:#f4f3f1;background-color:var(--color-background-lighter);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter);border-radius:4px;font-size:.875rem}.component-info,.component-info a,.component-info a [class*=icon]{color:#584b4f;color:var(--color-base)}.component-info a:hover{color:#afa1a5;color:var(--color-base-light);text-decoration:none}.component-info pre{line-height:1;font-size:.75rem}.component-info__title{display:-ms-flexbox;display:flex;font-size:1.5rem;line-height:1rem;margin-bottom:1rem;color:#584b4f;color:var(--color-base);-ms-flex-align:center;align-items:center}.component-info__title a{text-decoration:none}.component-info__title>:not(:last-child){margin-right:8px}.component-info__subtitle{font-size:.875rem;line-height:.875rem;font-weight:700;text-transform:uppercase;letter-spacing:.1em;margin-bottom:.875rem;color:#afa1a5;color:var(--color-base-light)}.component-info__info{padding:0;list-style:none;display:-ms-flexbox;display:flex;-ms-flex-flow:row;flex-flow:row;-ms-flex-pack:start;justify-content:flex-start}.component-info__info li{margin-right:16px}.component-info__info li:last-child{margin-right:0}.component-info__info a{font-size:.75rem;text-decoration:none;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis}.component-info__contributors{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0;list-style:none}.component-info__contributors li{padding:0 4px 4px 0;margin:0}.component-info__contributors img{display:block;width:40px;height:auto;border-radius:2px}.component-info__contributors img,.component-info__participation{-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter)}.component-info__participation{background-color:#f9f9f8;background-color:var(--color-background-lightest);padding:8px;border-radius:4px;text-align:center}.component-info__participation svg{display:block;margin:auto;max-width:100%;height:auto!important}:root{--color-key:#4f5b93;--color-key-light:#a2aacd;--color-base:#584b4f;--color-base-light:#afa1a5;--color-green:#40a977;--color-green-light:#9ad8bb;--color-red:#ba3525;--color-red-light:#e79187;--color-background:#d6d1c8;--color-background-light:#eae8e3;--color-background-lighter:#f4f3f1;--color-background-lightest:#f9f9f8;--box-shadow-light:0 1px 0 0 rgba(0,0,0,0.15);--box-shadow-lighter:0 1px 0 0 rgba(0,0,0,0.1);--box-shadow-lightest:0 1px 0 0 rgba(0,0,0,0.08)}.version-selector{position:relative;font-size:.875rem;color:#fff}.version-selector :last-child{margin-bottom:0}.version-selector__button,.version-selector__version{-webkit-appearance:none;border:0;margin:0;text-shadow:none;-webkit-box-shadow:none;box-shadow:none;text-decoration:none;text-transform:none;overflow:visible;cursor:pointer;outline:none;display:-ms-flexbox;display:flex;background-color:#584b4f;background-color:var(--color-base);-webkit-box-shadow:0 1px 0 0 rgba(0,0,0,.1);box-shadow:0 1px 0 0 rgba(0,0,0,.1);-webkit-box-shadow:var(--box-shadow-lighter);box-shadow:var(--box-shadow-lighter);color:#fff;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:.75rem;font-weight:bolder;letter-spacing:normal;padding:.25rem .4rem .2rem;border-radius:4px}.version-selector__button{position:relative}.version-selector__button [class=icon-chevron-down]{display:inline-block;margin-left:4px}.version-selector__button [class=icon-chevron-up]{display:none;margin-left:4px}.version-selector__version{background-color:hsla(0,0%,100%,.33);border:1px solid transparent;text-decoration:none;color:#fff!important}.version-selector__version:hover{background-color:hsla(0,0%,100%,.11);border:1px solid hsla(0,0%,100%,.22)}.version-selector__button--dev,.version-selector__version--dev,.version-selector__version--dev:hover{background-color:#ba3525;background-color:var(--color-red)}.version-selector__button--latest,.version-selector__version--latest,.version-selector__version--latest:hover{background-color:#40a977;background-color:var(--color-green)}.version-selector__panel{position:fixed;top:-20000em;visibility:hidden}</style>
        <script async src="../assets/main.d691d407.js"></script>
            </head>

    <body>
            <header class="header">
            <div class="wrapper">
                <div class="header__container">
                    <a class="header__logo" href="../">
                        <svg xmlns="http://www.w3.org/2000/svg" width="320" height="47.29" viewBox="0 428.964 320 47.29"><path fill="#584B4F" d="M30.86 452.385c1.637-2.287 2.455-5 2.455-8.134 0-4.313-1.367-7.87-4.088-10.68-2.723-2.812-6.39-4.216-11.004-4.216h-7.71c-3.79 0-6.49.798-8.1 2.388C.806 433.332 0 435.872 0 439.355v36.512h9.08v-17.245h6.53l9.08 17.245h10.52L24.82 457.12c2.395-.87 4.41-2.447 6.04-4.735zm-8.488-3.334c-1.24 1.33-2.82 1.99-4.734 1.99H9.08v-9.47c0-2.74 1.35-4.112 4.05-4.112h4.508c2 0 3.603.61 4.8 1.83 1.196 1.22 1.797 2.82 1.797 4.802 0 1.982-.623 3.64-1.864 4.964v-.003zm20.348 14.536c0 4.572 1.055 7.766 3.167 9.57 2.114 1.81 5.782 2.71 11.008 2.71h16.46v-8.1H57.548c-2.18 0-3.68-.35-4.51-1.045-.83-.695-1.24-1.96-1.24-3.788v-6.467h14.434l.656-8.1h-15.09v-10.912h21.56v-8.098H42.72v34.23zm57.97-33.442c-.718-.523-1.665-.787-2.84-.787-1.177 0-2.168.285-2.972.85-.807.567-1.537 1.592-2.19 3.073l-14.89 42.585h9.47l2.55-8.03h15.613l2.613 8.03h9.47l-14.893-42.588c-.567-1.572-1.21-2.613-1.93-3.135v.002zM92.1 460.19l5.75-18.42 5.487 18.418H92.1v.002zm53.074 5.455c-1.155 1.678-3.245 2.512-6.27 2.512-3.03 0-5.258-.914-6.697-2.74-1.394-1.83-2.093-5.25-2.093-10.256v-4.052c0-1.783.045-3.2.13-4.243.178-3.27.785-5.576 1.833-6.928 1.48-1.914 3.745-2.873 6.794-2.873 2.613 0 4.532.653 5.75 1.96 1.218 1.308 2.07 3.245 2.547 5.813h8.49c0-5.14-1.557-9.07-4.67-11.79-3.114-2.723-7.153-4.084-12.116-4.084-3.398 0-6.293.564-8.687 1.7-6.097 2.783-9.146 9.686-9.146 20.704v3.918c0 13.982 5.945 20.968 17.833 20.968 5.4 0 9.58-1.59 12.54-4.77 2.964-3.176 4.44-7.73 4.44-13.653h-8.426c-.346 3.53-1.1 6.134-2.25 7.81v.005zm14.667-36.29v8.1h12.412v38.41h9.08v-38.41h12.47v-8.1"/><path fill="#4F5B93" d="M218.89 429.356h-18.03v46.51h9.086v-14.897h8.944c4.876 0 8.647-1.337 11.328-4.016 2.683-2.68 4.02-6.608 4.02-11.788s-1.337-9.112-4.02-11.788c-2.68-2.68-6.454-4.02-11.328-4.02v-.002zm4.538 21.686c-1.15 1.177-2.815 1.768-5 1.768h-8.485v-15.354h8.484c4.483 0 6.73 2.572 6.73 7.71 0 2.744-.578 4.703-1.73 5.88v-.004zm43.93-2.02H250.31v-19.666h-9.088v46.51h9.086v-18.81h17.05v18.81h9.076v-46.51h-9.078m48.63 4.02c-2.683-2.68-6.46-4.02-11.335-4.02h-18.027v46.507h9.085V460.97h8.943c4.877 0 8.654-1.336 11.337-4.014 2.68-2.678 4.013-6.608 4.013-11.788s-1.332-9.112-4.013-11.79v-.003zm-6.795 17.666c-1.154 1.177-2.822 1.768-5 1.768h-8.484v-15.354h8.485c4.483 0 6.734 2.572 6.734 7.71 0 2.744-.583 4.703-1.735 5.88v-.004z"/></svg>
                    </a>
                    <form class="header__search">
                        <input type="search" class="searchbox searchbox--collapsed" data-docsearch placeholder="Search documentation...">
                    </form>
                    <div class="header__menu">
    <button class="hamburger" data-ctrly="off-canvas-menu" data-off-canvas-menu-control>
        <div class="hamburger__box">
            <div class="hamburger__inner">
                <span class="visually-hidden">Menu</span>
            </div>
        </div>
    </button>
</div>
<nav id="off-canvas-menu" class="off-canvas-menu" aria-hidden="true" tabindex="0">
    <div class="off-canvas-menu__content">
        <button aria-label="Close menu" class="off-canvas-menu__close" data-ctrly="off-canvas-menu" data-off-canvas-menu-control>
            <i class="icon-x" aria-hidden="true"></i>
        </button>

        <section class="off-canvas-menu__section">
            <a class="off-canvas-menu__section-top" href="../">Home</a>
        </section>

        <section class="off-canvas-menu__section">
            <a class="off-canvas-menu__section-top" href="../changelog.html">Changelog</a>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Core Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../event-loop/">
                        EventLoop

                        <span class="off-canvas-menu__version">
                            v1.2.0
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../stream/">
                        Stream

                        <span class="off-canvas-menu__version">
                            v1.2.0
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../promise/">
                        Promise

                        <span class="off-canvas-menu__version">
                            v2.8.0
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Network Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../socket/">
                        Socket

                        <span class="off-canvas-menu__version">
                            v1.11.0
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../datagram/">
                        Datagram

                        <span class="off-canvas-menu__version">
                            v1.8.0
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../http/">
                        HTTP

                        <span class="off-canvas-menu__version">
                            v1.6.0
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../dns/">
                        DNS

                        <span class="off-canvas-menu__version">
                            v1.9.0
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Utility Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../cache/">
                        Cache

                        <span class="off-canvas-menu__version">
                            v1.1.1
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../child-process/">
                        ChildProcess

                        <span class="off-canvas-menu__version">
                            v0.6.4
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../promise-timer/">
                        PromiseTimer

                        <span class="off-canvas-menu__version">
                            v1.8.0
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../promise-stream/">
                        PromiseStream

                        <span class="off-canvas-menu__version">
                            v1.3.0
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Legacy Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../http-client/">
                        HttpClient

                        <span class="off-canvas-menu__version">
                            v0.5.11
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../socket-client/">
                        SocketClient

                        <span class="off-canvas-menu__version">
                            v0.7.0
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
        </div>
</nav>
                </div>
            </div>
        </header>
    
        <div class="container">
        <div class="wrapper">
            <div class="grid grid--wrap grid--gutter">
                <main class="main">
                                    <h1>ChildProcess</h1>

                    
<p><a href="https://github.com/reactphp/child-process/actions"><img src="https://github.com/reactphp/child-process/workflows/CI/badge.svg" alt="CI status" style="max-width:100%;"></a></p>
<p>Event-driven library for executing child processes with
<a href="https://reactphp.org/" rel="nofollow">ReactPHP</a>.</p>
<p>This library integrates <a href="http://php.net/manual/en/book.exec.php" rel="nofollow">Program Execution</a>
with the <a href="../event-loop/">EventLoop</a>.
Child processes launched may be signaled and will emit an
<code>exit</code> event upon termination.
Additionally, process I/O streams (i.e. STDIN, STDOUT, STDERR) are exposed
as <a href="../stream/">Streams</a>.</p>
<p><strong>Table of contents</strong></p>
<ul>
<li><a href="#quickstart-example">Quickstart example</a></li>
<li>
<a href="#process">Process</a>
<ul>
<li><a href="#stream-properties">Stream Properties</a></li>
<li><a href="#command">Command</a></li>
<li><a href="#termination">Termination</a></li>
<li><a href="#custom-pipes">Custom pipes</a></li>
<li><a href="#sigchild-compatibility">Sigchild Compatibility</a></li>
<li><a href="#windows-compatibility">Windows Compatibility</a></li>
</ul>
</li>
<li><a href="#install">Install</a></li>
<li><a href="#tests">Tests</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2>
<a id="quickstart-example" class="anchor" href="#quickstart-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quickstart example</h2>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">React</span>\<span class="pl-v">ChildProcess</span>\<span class="pl-v">Process</span>(<span class="pl-s">'echo foo'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdout</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'data'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>chunk</span>) {
    <span class="pl-k">echo</span> <span class="pl-s1"><span class="pl-c1">$</span>chunk</span>;
});

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'exit'</span>, <span class="pl-k">function</span>(<span class="pl-s1"><span class="pl-c1">$</span>exitCode</span>, <span class="pl-s1"><span class="pl-c1">$</span>termSignal</span>) {
    <span class="pl-k">echo</span> <span class="pl-s">'Process exited with code '</span> . <span class="pl-s1"><span class="pl-c1">$</span>exitCode</span> . <span class="pl-c1">PHP_EOL</span>;
});</pre></div>
<p>See also the <a href="https://github.com/reactphp/child-process/blob/v0.6.4/examples">examples</a>.</p>
<h2>
<a id="process" class="anchor" href="#process" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Process</h2>
<h3>
<a id="stream-properties" class="anchor" href="#stream-properties" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Stream Properties</h3>
<p>Once a process is started, its I/O streams will be constructed as instances of
<code>React\Stream\ReadableStreamInterface</code> and <code>React\Stream\WritableStreamInterface</code>.
Before <code>start()</code> is called, these properties are not set. Once a process terminates,
the streams will become closed but not unset.</p>
<p>Following common Unix conventions, this library will start each child process
with the three pipes matching the standard I/O streams as given below by default.
You can use the named references for common use cases or access these as an
array with all three pipes.</p>
<ul>
<li>
<code>$stdin</code>  or <code>$pipes[0]</code> is a <code>WritableStreamInterface</code>
</li>
<li>
<code>$stdout</code> or <code>$pipes[1]</code> is a <code>ReadableStreamInterface</code>
</li>
<li>
<code>$stderr</code> or <code>$pipes[2]</code> is a <code>ReadableStreamInterface</code>
</li>
</ul>
<p>Note that this default configuration may be overridden by explicitly passing
<a href="#custom-pipes">custom pipes</a>, in which case they may not be set or be assigned
different values. In particular, note that <a href="#windows-compatibility">Windows support</a>
is limited in that it doesn't support non-blocking STDIO pipes. The <code>$pipes</code>
array will always contain references to all pipes as configured and the standard
I/O references will always be set to reference the pipes matching the above
conventions. See <a href="#custom-pipes">custom pipes</a> for more details.</p>
<p>Because each of these implement the underlying
<a href="../stream/#readablestreaminterface"><code>ReadableStreamInterface</code></a> or
<a href="../stream/#writablestreaminterface"><code>WritableStreamInterface</code></a>,
you can use any of their events and methods as usual:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s1"><span class="pl-c1">$</span>command</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdout</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'data'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>chunk</span>) {
    <span class="pl-k">echo</span> <span class="pl-s1"><span class="pl-c1">$</span>chunk</span>;
});

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdout</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'end'</span>, <span class="pl-k">function</span> () {
    <span class="pl-k">echo</span> <span class="pl-s">'ended'</span>;
});

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdout</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'error'</span>, <span class="pl-k">function</span> (<span class="pl-smi">Exception</span> <span class="pl-s1"><span class="pl-c1">$</span>e</span>) {
    <span class="pl-k">echo</span> <span class="pl-s">'error: '</span> . <span class="pl-s1"><span class="pl-c1">$</span>e</span>-&gt;<span class="pl-en">getMessage</span>();
});

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdout</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'close'</span>, <span class="pl-k">function</span> () {
    <span class="pl-k">echo</span> <span class="pl-s">'closed'</span>;
});

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdin</span>-&gt;<span class="pl-en">write</span>(<span class="pl-s1"><span class="pl-c1">$</span>data</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdin</span>-&gt;<span class="pl-en">end</span>(<span class="pl-s1"><span class="pl-c1">$</span>data</span> = <span class="pl-c1">null</span>);
<span class="pl-c">// …</span></pre></div>
<p>For more details, see the
<a href="../stream/#readablestreaminterface"><code>ReadableStreamInterface</code></a> and
<a href="../stream/#writablestreaminterface"><code>WritableStreamInterface</code></a>.</p>
<h3>
<a id="command" class="anchor" href="#command" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Command</h3>
<p>The <code>Process</code> class allows you to pass any kind of command line string:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'echo test'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>The command line string usually consists of a whitespace-separated list with
your main executable bin and any number of arguments. Special care should be
taken to escape or quote any arguments, escpecially if you pass any user input
along. Likewise, keep in mind that especially on Windows, it is rather common to
have path names containing spaces and other special characters. If you want to
run a binary like this, you will have to ensure this is quoted as a single
argument using <code>escapeshellarg()</code> like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>bin</span> = <span class="pl-s">'C:\\Program files (x86)\\PHP\\php.exe'</span>;
<span class="pl-s1"><span class="pl-c1">$</span>file</span> = <span class="pl-s">'C:\\Users\\me\\Desktop\\Application\\main.php'</span>;

<span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-en">escapeshellarg</span>(<span class="pl-s1"><span class="pl-c1">$</span>bin</span>) . <span class="pl-s">' '</span> . <span class="pl-en">escapeshellarg</span>(<span class="pl-s1"><span class="pl-c1">$</span>file</span>));
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>By default, PHP will launch processes by wrapping the given command line string
in a <code>sh</code> command on Unix, so that the first example will actually execute
<code>sh -c echo test</code> under the hood on Unix. On Windows, it will not launch
processes by wrapping them in a shell.</p>
<p>This is a very useful feature because it does not only allow you to pass single
commands, but actually allows you to pass any kind of shell command line and
launch multiple sub-commands using command chains (with <code>&amp;&amp;</code>, <code>||</code>, <code>;</code> and
others) and allows you to redirect STDIO streams (with <code>2&gt;&amp;1</code> and family).
This can be used to pass complete command lines and receive the resulting STDIO
streams from the wrapping shell command like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'echo run &amp;&amp; demo || echo failed'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<blockquote>
<p>Note that <a href="#windows-compatibility">Windows support</a> is limited in that it
doesn't support STDIO streams at all and also that processes will not be run
in a wrapping shell by default. If you want to run a shell built-in function
such as <code>echo hello</code> or <code>sleep 10</code>, you may have to prefix your command line
with an explicit shell like <code>cmd /c echo hello</code>.</p>
</blockquote>
<p>In other words, the underlying shell is responsible for managing this command
line and launching the individual sub-commands and connecting their STDIO
streams as appropriate.
This implies that the <code>Process</code> class will only receive the resulting STDIO
streams from the wrapping shell, which will thus contain the complete
input/output with no way to discern the input/output of single sub-commands.</p>
<p>If you want to discern the output of single sub-commands, you may want to
implement some higher-level protocol logic, such as printing an explicit
boundary between each sub-command like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'cat first &amp;&amp; echo --- &amp;&amp; cat second'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>As an alternative, considering launching one process at a time and listening on
its <code>exit</code> event to conditionally start the next process in the chain.
This will give you an opportunity to configure the subsequent process I/O streams:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>first</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'cat first'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>first</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>first</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'exit'</span>, <span class="pl-k">function</span> () {
    <span class="pl-s1"><span class="pl-c1">$</span>second</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'cat second'</span>);
    <span class="pl-s1"><span class="pl-c1">$</span>second</span>-&gt;<span class="pl-en">start</span>();
});</pre></div>
<p>Keep in mind that PHP uses the shell wrapper for ALL command lines on Unix.
While this may seem reasonable for more complex command lines, this actually
also applies to running the most simple single command:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'yes'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>This will actually spawn a command hierarchy similar to this on Unix:</p>
<pre><code>5480 … \_ php example.php
5481 …    \_ sh -c yes
5482 …        \_ yes
</code></pre>
<p>This means that trying to get the underlying process PID or sending signals
will actually target the wrapping shell, which may not be the desired result
in many cases.</p>
<p>If you do not want this wrapping shell process to show up, you can simply
prepend the command string with <code>exec</code> on Unix platforms, which will cause the
wrapping shell process to be replaced by our process:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'exec yes'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>This will show a resulting command hierarchy similar to this:</p>
<pre><code>5480 … \_ php example.php
5481 …    \_ yes
</code></pre>
<p>This means that trying to get the underlying process PID and sending signals
will now target the actual command as expected.</p>
<p>Note that in this case, the command line will not be run in a wrapping shell.
This implies that when using <code>exec</code>, there's no way to pass command lines such
as those containing command chains or redirected STDIO streams.</p>
<p>As a rule of thumb, most commands will likely run just fine with the wrapping
shell.
If you pass a complete command line (or are unsure), you SHOULD most likely keep
the wrapping shell.
If you're running on Unix and you want to pass an invidual command only, you MAY
want to consider prepending the command string with <code>exec</code> to avoid the wrapping shell.</p>
<h3>
<a id="termination" class="anchor" href="#termination" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Termination</h3>
<p>The <code>exit</code> event will be emitted whenever the process is no longer running.
Event listeners will receive the exit code and termination signal as two
arguments:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'sleep 10'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'exit'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>code</span>, <span class="pl-s1"><span class="pl-c1">$</span>term</span>) {
    <span class="pl-k">if</span> (<span class="pl-s1"><span class="pl-c1">$</span>term</span> === <span class="pl-c1">null</span>) {
        <span class="pl-k">echo</span> <span class="pl-s">'exit with code '</span> . <span class="pl-s1"><span class="pl-c1">$</span>code</span> . <span class="pl-c1">PHP_EOL</span>;
    } <span class="pl-k">else</span> {
        <span class="pl-k">echo</span> <span class="pl-s">'terminated with signal '</span> . <span class="pl-s1"><span class="pl-c1">$</span>term</span> . <span class="pl-c1">PHP_EOL</span>;
    }
});</pre></div>
<p>Note that <code>$code</code> is <code>null</code> if the process has terminated, but the exit
code could not be determined (for example
<a href="#sigchild-compatibility">sigchild compatibility</a> was disabled).
Similarly, <code>$term</code> is <code>null</code> unless the process has terminated in response to
an uncaught signal sent to it.
This is not a limitation of this project, but actual how exit codes and signals
are exposed on POSIX systems, for more details see also
<a href="https://unix.stackexchange.com/questions/99112/default-exit-code-when-process-is-terminated" rel="nofollow">here</a>.</p>
<p>It's also worth noting that process termination depends on all file descriptors
being closed beforehand.
This means that all <a href="#stream-properties">process pipes</a> will emit a <code>close</code>
event before the <code>exit</code> event and that no more <code>data</code> events will arrive after
the <code>exit</code> event.
Accordingly, if either of these pipes is in a paused state (<code>pause()</code> method
or internally due to a <code>pipe()</code> call), this detection may not trigger.</p>
<p>The <code>terminate(?int $signal = null): bool</code> method can be used to send the
process a signal (SIGTERM by default).
Depending on which signal you send to the process and whether it has a signal
handler registered, this can be used to either merely signal a process or even
forcefully terminate it.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">terminate</span>(<span class="pl-v">SIGUSR1</span>);</pre></div>
<p>Keep the above section in mind if you want to forcefully terminate a process.
If your process spawn sub-processes or implicitly uses the
<a href="#command">wrapping shell mentioned above</a>, its file descriptors may be
inherited to child processes and terminating the main process may not
necessarily terminate the whole process tree.
It is highly suggested that you explicitly <code>close()</code> all process pipes
accordingly when terminating a process:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'sleep 10'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-v">Loop</span>::<span class="pl-en">addTimer</span>(<span class="pl-c1">2.0</span>, <span class="pl-k">function</span> () <span class="pl-k">use</span> (<span class="pl-s1"><span class="pl-c1">$</span>process</span>) {
    <span class="pl-k">foreach</span> (<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">pipes</span> <span class="pl-k">as</span> <span class="pl-s1"><span class="pl-c1">$</span>pipe</span>) {
        <span class="pl-s1"><span class="pl-c1">$</span>pipe</span>-&gt;<span class="pl-en">close</span>();
    }
    <span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">terminate</span>();
});</pre></div>
<p>For many simple programs these seamingly complicated steps can also be avoided
by prefixing the command line with <code>exec</code> to avoid the wrapping shell and its
inherited process pipes as <a href="#command">mentioned above</a>.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'exec sleep 10'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-v">Loop</span>::<span class="pl-en">addTimer</span>(<span class="pl-c1">2.0</span>, <span class="pl-k">function</span> () <span class="pl-k">use</span> (<span class="pl-s1"><span class="pl-c1">$</span>process</span>) {
    <span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">terminate</span>();
});</pre></div>
<p>Many command line programs also wait for data on <code>STDIN</code> and terminate cleanly
when this pipe is closed.
For example, the following can be used to "soft-close" a <code>cat</code> process:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'cat'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-v">Loop</span>::<span class="pl-en">addTimer</span>(<span class="pl-c1">2.0</span>, <span class="pl-k">function</span> () <span class="pl-k">use</span> (<span class="pl-s1"><span class="pl-c1">$</span>process</span>) {
    <span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdin</span>-&gt;<span class="pl-en">end</span>();
});</pre></div>
<p>While process pipes and termination may seem confusing to newcomers, the above
properties actually allow some fine grained control over process termination,
such as first trying a soft-close and then applying a force-close after a
timeout.</p>
<h3>
<a id="custom-pipes" class="anchor" href="#custom-pipes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Custom pipes</h3>
<p>Following common Unix conventions, this library will start each child process
with the three pipes matching the standard I/O streams by default. For more
advanced use cases it may be useful to pass in custom pipes, such as explicitly
passing additional file descriptors (FDs) or overriding default process pipes.</p>
<p>Note that passing custom pipes is considered advanced usage and requires a
more in-depth understanding of Unix file descriptors and how they are inherited
to child processes and shared in multi-processing applications.</p>
<p>If you do not want to use the default standard I/O pipes, you can explicitly
pass an array containing the file descriptor specification to the constructor
like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>fds</span> = <span class="pl-en">array</span>(
    <span class="pl-c">// standard I/O pipes for stdin/stdout/stderr</span>
    <span class="pl-c1">0</span> =&gt; <span class="pl-en">array</span>(<span class="pl-s">'pipe'</span>, <span class="pl-s">'r'</span>),
    <span class="pl-c1">1</span> =&gt; <span class="pl-en">array</span>(<span class="pl-s">'pipe'</span>, <span class="pl-s">'w'</span>),
    <span class="pl-c1">2</span> =&gt; <span class="pl-en">array</span>(<span class="pl-s">'pipe'</span>, <span class="pl-s">'w'</span>),

    <span class="pl-c">// example FDs for files or open resources</span>
    <span class="pl-c1">4</span> =&gt; <span class="pl-en">array</span>(<span class="pl-s">'file'</span>, <span class="pl-s">'/dev/null'</span>, <span class="pl-s">'r'</span>),
    <span class="pl-c1">6</span> =&gt; <span class="pl-en">fopen</span>(<span class="pl-s">'log.txt'</span>,<span class="pl-s">'a'</span>),
    <span class="pl-c1">8</span> =&gt; <span class="pl-c1">STDERR</span>,

    <span class="pl-c">// example FDs for sockets</span>
    <span class="pl-c1">10</span> =&gt; <span class="pl-en">fsockopen</span>(<span class="pl-s">'localhost'</span>, <span class="pl-c1">8080</span>),
    <span class="pl-c1">12</span> =&gt; <span class="pl-en">stream_socket_server</span>(<span class="pl-s">'tcp://0.0.0.0:4711'</span>)
);

<span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s1"><span class="pl-c1">$</span>cmd</span>, <span class="pl-c1">null</span>, <span class="pl-c1">null</span>, <span class="pl-s1"><span class="pl-c1">$</span>fds</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>Unless your use case has special requirements that demand otherwise, you're
highly recommended to (at least) pass in the standard I/O pipes as given above.
The file descriptor specification accepts arguments in the exact same format
as the underlying <a href="http://php.net/proc_open" rel="nofollow"><code>proc_open()</code></a> function.</p>
<p>Once the process is started, the <code>$pipes</code> array will always contain references to
all pipes as configured and the standard I/O references will always be set to
reference the pipes matching common Unix conventions. This library supports any
number of pipes and additional file descriptors, but many common applications
being run as a child process will expect that the parent process properly
assigns these file descriptors.</p>
<h3>
<a id="sigchild-compatibility" class="anchor" href="#sigchild-compatibility" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sigchild Compatibility</h3>
<p>Internally, this project uses a work-around to improve compatibility when PHP
has been compiled with the <code>--enable-sigchild</code> option. This should not affect most
installations as this configure option is not used by default and many
distributions (such as Debian and Ubuntu) are known to not use this by default.
Some installations that use <a href="http://php.net/manual/en/book.oci8.php" rel="nofollow">Oracle OCI8</a>
may use this configure option to circumvent <code>defunct</code> processes.</p>
<p>When PHP has been compiled with the <code>--enable-sigchild</code> option, a child process'
exit code cannot be reliably determined via <code>proc_close()</code> or <code>proc_get_status()</code>.
To work around this, we execute the child process with an additional pipe and
use that to retrieve its exit code.</p>
<p>This work-around incurs some overhead, so we only trigger this when necessary
and when we detect that PHP has been compiled with the <code>--enable-sigchild</code> option.
Because PHP does not provide a way to reliably detect this option, we try to
inspect output of PHP's configure options from the <code>phpinfo()</code> function.</p>
<p>The static <code>setSigchildEnabled(bool $sigchild): void</code> method can be used to
explicitly enable or disable this behavior like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-c">// advanced: not recommended by default</span>
<span class="pl-v">Process</span>::<span class="pl-en">setSigchildEnabled</span>(<span class="pl-c1">true</span>);</pre></div>
<p>Note that all processes instantiated after this method call will be affected.
If this work-around is disabled on an affected PHP installation, the <code>exit</code>
event may receive <code>null</code> instead of the actual exit code as described above.
Similarly, some distributions are known to omit the configure options from
<code>phpinfo()</code>, so automatic detection may fail to enable this work-around in some
cases. You may then enable this  explicitly as given above.</p>
<p><strong>Note:</strong> The original functionality was taken from Symfony's
<a href="https://github.com/symfony/process">Process</a> compoment.</p>
<h3>
<a id="windows-compatibility" class="anchor" href="#windows-compatibility" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Windows Compatibility</h3>
<p>Due to platform constraints, this library provides only limited support for
spawning child processes on Windows. In particular, PHP does not allow accessing
standard I/O pipes on Windows without blocking. As such, this project will not
allow constructing a child process with the default process pipes and will
instead throw a <code>LogicException</code> on Windows by default:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-c">// throws LogicException on Windows</span>
<span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'ping example.com'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>There are a number of alternatives and workarounds as detailed below if you want
to run a child process on Windows, each with its own set of pros and cons:</p>
<ul>
<li>
<p>As of PHP 8, you can start the child process with <code>socket</code> pair descriptors
in place of normal standard I/O pipes like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(
    <span class="pl-s">'ping example.com'</span>,
    <span class="pl-c1">null</span>,
    <span class="pl-c1">null</span>,
    [
        [<span class="pl-s">'socket'</span>],
        [<span class="pl-s">'socket'</span>],
        [<span class="pl-s">'socket'</span>]
    ]
);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-c1">stdout</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'data'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>chunk</span>) {
    <span class="pl-k">echo</span> <span class="pl-s1"><span class="pl-c1">$</span>chunk</span>;
});</pre></div>
<p>These <code>socket</code> pairs support non-blocking process I/O on any platform,
including Windows. However, not all programs accept stdio sockets.</p>
</li>
<li>
<p>This package does work on
<a href="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux" rel="nofollow"><code>Windows Subsystem for Linux</code></a>
(or WSL) without issues. When you are in control over how your application is
deployed, we recommend <a href="https://msdn.microsoft.com/en-us/commandline/wsl/install_guide" rel="nofollow">installing WSL</a>
when you want to run this package on Windows.</p>
</li>
<li>
<p>If you only care about the exit code of a child process to check if its
execution was successful, you can use <a href="#custom-pipes">custom pipes</a> to omit
any standard I/O pipes like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'ping example.com'</span>, <span class="pl-c1">null</span>, <span class="pl-c1">null</span>, <span class="pl-en">array</span>());
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'exit'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>exitcode</span>) {
    <span class="pl-k">echo</span> <span class="pl-s">'exit with '</span> . <span class="pl-s1"><span class="pl-c1">$</span>exitcode</span> . <span class="pl-c1">PHP_EOL</span>;
});</pre></div>
<p>Similarly, this is also useful if your child process communicates over
sockets with remote servers or even your parent process using the
<a href="../socket/">Socket component</a>. This is usually
considered the best alternative if you have control over how your child
process communicates with the parent process.</p>
</li>
<li>
<p>If you only care about command output after the child process has been
executed, you can use <a href="#custom-pipes">custom pipes</a> to configure file
handles to be passed to the child process instead of pipes like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'ping example.com'</span>, <span class="pl-c1">null</span>, <span class="pl-c1">null</span>, <span class="pl-en">array</span>(
    <span class="pl-en">array</span>(<span class="pl-s">'file'</span>, <span class="pl-s">'nul'</span>, <span class="pl-s">'r'</span>),
    <span class="pl-s1"><span class="pl-c1">$</span>stdout</span> = <span class="pl-en">tmpfile</span>(),
    <span class="pl-en">array</span>(<span class="pl-s">'file'</span>, <span class="pl-s">'nul'</span>, <span class="pl-s">'w'</span>)
));
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'exit'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>exitcode</span>) <span class="pl-k">use</span> (<span class="pl-s1"><span class="pl-c1">$</span>stdout</span>) {
    <span class="pl-k">echo</span> <span class="pl-s">'exit with '</span> . <span class="pl-s1"><span class="pl-c1">$</span>exitcode</span> . <span class="pl-c1">PHP_EOL</span>;

    <span class="pl-c">// rewind to start and then read full file (demo only, this is blocking).</span>
    <span class="pl-c">// reading from shared file is only safe if you have some synchronization in place</span>
    <span class="pl-c">// or after the child process has terminated.</span>
    <span class="pl-en">rewind</span>(<span class="pl-s1"><span class="pl-c1">$</span>stdout</span>);
    <span class="pl-k">echo</span> <span class="pl-en">stream_get_contents</span>(<span class="pl-s1"><span class="pl-c1">$</span>stdout</span>);
    <span class="pl-en">fclose</span>(<span class="pl-s1"><span class="pl-c1">$</span>stdout</span>);
});</pre></div>
<p>Note that this example uses <code>tmpfile()</code>/<code>fopen()</code> for illustration purposes only.
This should not be used in a truly async program because the filesystem is
inherently blocking and each call could potentially take several seconds.
See also the <a href="https://github.com/reactphp/filesystem">Filesystem component</a> as an
alternative.</p>
</li>
<li>
<p>If you want to access command output as it happens in a streaming fashion,
you can use redirection to spawn an additional process to forward your
standard I/O streams to a socket and use <a href="#custom-pipes">custom pipes</a> to
omit any actual standard I/O pipes like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>server</span> = <span class="pl-k">new</span> <span class="pl-v">React</span>\<span class="pl-v">Socket</span>\<span class="pl-v">Server</span>(<span class="pl-s">'127.0.0.1:0'</span>);
<span class="pl-s1"><span class="pl-c1">$</span>server</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'connection'</span>, <span class="pl-k">function</span> (<span class="pl-v">React</span>\<span class="pl-v">Socket</span>\<span class="pl-smi">ConnectionInterface</span> <span class="pl-s1"><span class="pl-c1">$</span>connection</span>) {
    <span class="pl-s1"><span class="pl-c1">$</span>connection</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'data'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>chunk</span>) {
        <span class="pl-k">echo</span> <span class="pl-s1"><span class="pl-c1">$</span>chunk</span>;
    });
});

<span class="pl-s1"><span class="pl-c1">$</span>command</span> = <span class="pl-s">'ping example.com | foobar '</span> . <span class="pl-en">escapeshellarg</span>(<span class="pl-s1"><span class="pl-c1">$</span>server</span>-&gt;<span class="pl-en">getAddress</span>());
<span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s1"><span class="pl-c1">$</span>command</span>, <span class="pl-c1">null</span>, <span class="pl-c1">null</span>, <span class="pl-en">array</span>());
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();

<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">on</span>(<span class="pl-s">'exit'</span>, <span class="pl-k">function</span> (<span class="pl-s1"><span class="pl-c1">$</span>exitcode</span>) <span class="pl-k">use</span> (<span class="pl-s1"><span class="pl-c1">$</span>server</span>) {
    <span class="pl-s1"><span class="pl-c1">$</span>server</span>-&gt;<span class="pl-en">close</span>();
    <span class="pl-k">echo</span> <span class="pl-s">'exit with '</span> . <span class="pl-s1"><span class="pl-c1">$</span>exitcode</span> . <span class="pl-c1">PHP_EOL</span>;
});</pre></div>
<p>Note how this will spawn another fictional <code>foobar</code> helper program to consume
the standard output from the actual child process. This is in fact similar
to the above recommendation of using socket connections in the child process,
but in this case does not require modification of the actual child process.</p>
<p>In this example, the fictional <code>foobar</code> helper program can be implemented by
simply consuming all data from standard input and forwarding it to a socket
connection like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>socket</span> = <span class="pl-en">stream_socket_client</span>(<span class="pl-s1"><span class="pl-c1">$</span>argv</span>[<span class="pl-c1">1</span>]);
<span class="pl-k">do</span> {
    <span class="pl-en">fwrite</span>(<span class="pl-s1"><span class="pl-c1">$</span>socket</span>, <span class="pl-s1"><span class="pl-c1">$</span>data</span> = <span class="pl-en">fread</span>(<span class="pl-c1">STDIN</span>, <span class="pl-c1">8192</span>));
} <span class="pl-k">while</span> (<span class="pl-en">isset</span>(<span class="pl-s1"><span class="pl-c1">$</span>data</span>[<span class="pl-c1">0</span>]));</pre></div>
<p>Accordingly, this example can also be run with plain PHP without having to
rely on any external helper program like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>code</span> = <span class="pl-s">'$s=stream_socket_client($argv[1]);do{fwrite($s,$d=fread(STDIN, 8192));}while(isset($d[0]));'</span>;
<span class="pl-s1"><span class="pl-c1">$</span>command</span> = <span class="pl-s">'ping example.com | php -r '</span> . <span class="pl-en">escapeshellarg</span>(<span class="pl-s1"><span class="pl-c1">$</span>code</span>) . <span class="pl-s">' '</span> . <span class="pl-en">escapeshellarg</span>(<span class="pl-s1"><span class="pl-c1">$</span>server</span>-&gt;<span class="pl-en">getAddress</span>());
<span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s1"><span class="pl-c1">$</span>command</span>, <span class="pl-c1">null</span>, <span class="pl-c1">null</span>, <span class="pl-en">array</span>());
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<p>See also <a href="https://github.com/reactphp/child-process/blob/v0.6.4/examples/23-forward-socket.php">example #23</a>.</p>
<p>Note that this is for illustration purposes only and you may want to implement
some proper error checks and/or socket verification in actual production use
if you do not want to risk other processes connecting to the server socket.
In this case, we suggest looking at the excellent
<a href="https://github.com/cubiclesoft/createprocess-windows">createprocess-windows</a>.</p>
</li>
</ul>
<p>Additionally, note that the <a href="#command">command</a> given to the <code>Process</code> will be
passed to the underlying Windows-API
(<a href="https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa" rel="nofollow"><code>CreateProcess</code></a>)
as-is and the process will not be launched in a wrapping shell by default. In
particular, this means that shell built-in functions such as <code>echo hello</code> or
<code>sleep 10</code> may have to be prefixed with an explicit shell command like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">$</span>process</span> = <span class="pl-k">new</span> <span class="pl-v">Process</span>(<span class="pl-s">'cmd /c echo hello'</span>, <span class="pl-c1">null</span>, <span class="pl-c1">null</span>, <span class="pl-s1"><span class="pl-c1">$</span>pipes</span>);
<span class="pl-s1"><span class="pl-c1">$</span>process</span>-&gt;<span class="pl-en">start</span>();</pre></div>
<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Install</h2>
<p>The recommended way to install this library is <a href="https://getcomposer.org" rel="nofollow">through Composer</a>.
<a href="https://getcomposer.org/doc/00-intro.md" rel="nofollow">New to Composer?</a></p>
<p>This will install the latest supported version:</p>
<div class="highlight highlight-source-shell"><pre>$ composer require react/child-process:^0.6.4</pre></div>
<p>See also the <a href="changelog.html">CHANGELOG</a> for details about version upgrades.</p>
<p>This project aims to run on any platform and thus does not require any PHP
extensions and supports running on legacy PHP 5.3 through current PHP 8+ and HHVM.
It's <em>highly recommended to use PHP 7+</em> for this project.</p>
<p>See above note for limited <a href="#windows-compatibility">Windows Compatibility</a>.</p>
<h2>
<a id="tests" class="anchor" href="#tests" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tests</h2>
<p>To run the test suite, you first need to clone this repo and then install all
dependencies <a href="https://getcomposer.org" rel="nofollow">through Composer</a>:</p>
<div class="highlight highlight-source-shell"><pre>$ composer install</pre></div>
<p>To run the test suite, go to the project root and run:</p>
<div class="highlight highlight-source-shell"><pre>$ php vendor/bin/phpunit</pre></div>
<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>
<p>MIT, see <a href="license.html">LICENSE file</a>.</p>
                                </main>
                <aside class="sidebar" role="complementary">
                    <section class="component-info">
                        <h2 class="component-info__title">
                            <a href="../child-process/">ChildProcess</a>

                            <div class="version-selector">
                                <button class="version-selector__button version-selector__button--latest" data-ctrly="component-version-selector" data-version-selector-control>
                                    v0.6.4

                                    <i class="icon-chevron-down" aria-hidden="true"></i>
                                    <i class="icon-chevron-up" aria-hidden="true"></i>
                                </button>

                                <div id="component-version-selector" class="version-selector__panel" aria-hidden="true">
                                    <p>Read the documentation of development and older versions on GitHub:</p>

                                    <ul class="version-selector__list">
                                        <li>
                                            <a href="https://github.com/reactphp/child-process#readme" class="version-selector__version version-selector__version--dev">
                                                master
                                            </a>
                                        </li>
                                                                                                                                                                                                                    <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.6.3#readme" class="version-selector__version">
                                                    v0.6.3
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.6.2#readme" class="version-selector__version">
                                                    v0.6.2
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.6.1#readme" class="version-selector__version">
                                                    v0.6.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.6.0#readme" class="version-selector__version">
                                                    v0.6.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.5.2#readme" class="version-selector__version">
                                                    v0.5.2
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.5.1#readme" class="version-selector__version">
                                                    v0.5.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.5.0#readme" class="version-selector__version">
                                                    v0.5.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.4.3#readme" class="version-selector__version">
                                                    v0.4.3
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.4.2#readme" class="version-selector__version">
                                                    v0.4.2
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.4.1#readme" class="version-selector__version">
                                                    v0.4.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.3.0#readme" class="version-selector__version">
                                                    v0.3.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/child-process/tree/v0.4.0#readme" class="version-selector__version">
                                                    v0.4.0
                                                </a>
                                            </li>
                                                                                                                        </ul>
                                </div>
                            </div>
                        </h2>

                        <ul class="component-info__info">
                            <li>
                                <a href="https://github.com/reactphp/child-process">
                                    <i class="icon-github" aria-hidden="true"></i> Repository
                                </a>
                            </li>
                            <li>
                                <a href="../child-process/changelog.html">
                                    <i class="icon-calendar" aria-hidden="true"></i> Changelog
                                </a>
                            </li>
                            <li>
                                <a href="../child-process/license.html">
                                    <i class="icon-law" aria-hidden="true"></i> MIT License
                                </a>
                            </li>
                        </ul>

                        <h3 class="component-info__subtitle">Installation</h3>

                        <div class="highlight highlight-source-shell"><pre>composer require react/child-process:^0.6.4</pre></div>

                        <h3 class="component-info__subtitle">Contributors</h3>

                        <ul class="component-info__contributors">
                                                    <li>
                                <a href="https://github.com/clue">
                                    <img src="https://avatars.githubusercontent.com/u/776829?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/776829?v=4&amp;s=80 2x" alt="clue" title="clue (69 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/WyriHaximus">
                                    <img src="https://avatars.githubusercontent.com/u/147145?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/147145?v=4&amp;s=80 2x" alt="WyriHaximus" title="WyriHaximus (48 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/jmikola">
                                    <img src="https://avatars.githubusercontent.com/u/244663?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/244663?v=4&amp;s=80 2x" alt="jmikola" title="jmikola (20 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/cboden">
                                    <img src="https://avatars.githubusercontent.com/u/617694?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/617694?v=4&amp;s=80 2x" alt="cboden" title="cboden (17 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/jsor">
                                    <img src="https://avatars.githubusercontent.com/u/55574?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/55574?v=4&amp;s=80 2x" alt="jsor" title="jsor (10 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/SimonFrings">
                                    <img src="https://avatars.githubusercontent.com/u/44357440?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/44357440?v=4&amp;s=80 2x" alt="SimonFrings" title="SimonFrings (3 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/igorw">
                                    <img src="https://avatars.githubusercontent.com/u/88061?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/88061?v=4&amp;s=80 2x" alt="igorw" title="igorw (2 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/staabm">
                                    <img src="https://avatars.githubusercontent.com/u/120441?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/120441?v=4&amp;s=80 2x" alt="staabm" title="staabm (2 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/gdejong">
                                    <img src="https://avatars.githubusercontent.com/u/2346366?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/2346366?v=4&amp;s=80 2x" alt="gdejong" title="gdejong (2 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/iamluc">
                                    <img src="https://avatars.githubusercontent.com/u/1539731?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/1539731?v=4&amp;s=80 2x" alt="iamluc" title="iamluc (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/mdrost">
                                    <img src="https://avatars.githubusercontent.com/u/4083346?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/4083346?v=4&amp;s=80 2x" alt="mdrost" title="mdrost (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/reedy">
                                    <img src="https://avatars.githubusercontent.com/u/67615?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/67615?v=4&amp;s=80 2x" alt="reedy" title="reedy (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/e3betht">
                                    <img src="https://avatars.githubusercontent.com/u/1811561?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/1811561?v=4&amp;s=80 2x" alt="e3betht" title="e3betht (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/mbonneau">
                                    <img src="https://avatars.githubusercontent.com/u/748287?v=4&amp;s=40" srcset="https://avatars.githubusercontent.com/u/748287?v=4&amp;s=80 2x" alt="mbonneau" title="mbonneau (1 contribution)">
                                </a>
                            </li>
                                                </ul>

                        <h3 class="component-info__subtitle">Activity</h3>

                        <div class="component-info__participation">
                            <svg width="320" height="42">
    <defs>
        <linearGradient id="reactphp-child-process-participation-gradient" x1="0" x2="0" y1="1" y2="0">
            <stop offset="10%" stop-color="#40a977"></stop>
            <stop offset="90%" stop-color="#ba3525"></stop>
        </linearGradient>
        <mask id="reactphp-child-process-participation-sparkline" x="0" y="0" width="320" height="40" >
            <polyline 
                transform="translate(0, 40) scale(1,-1)"
                points="0,3 6,1 12,1 18,1 24,1 30,1 36,1 42,1 48,1 54,1 60,1 66,1 72,1 78,1 84,1 90,1 96,1 102,1 108,1 114,1 120,1 126,1 132,5 138,1 144,1 150,1 156,1 162,1 168,1 174,1 180,1 186,1 192,1 198,1 204,3 210,4 216,1 222,1 228,1 234,1 240,3 246,1 252,1 258,1 264,1 270,1 276,1 282,1 288,1 294,1 300,1 306,1" 
                fill="transparent" 
                stroke="#40a977" 
                stroke-width="2"
            >
        </mask>
    </defs>

    <g transform="translate(0, -1.5)">
        <rect 
            x="0" 
            y="-2" 
            width="320" 
            height="42"
            style="stroke:none;fill:url(#reactphp-child-process-participation-gradient);mask:url(#reactphp-child-process-participation-sparkline)"
        ></rect>
    </g>
</svg>
                        </div>
                    </section>
                </aside>
            </div>
        </div>
    </div>

            <footer class="footer">
            <div class="wrapper">
                <ul class="links">
                    <li><a href="https://github.com/reactphp"><i class="icon-github" aria-hidden="true"></i> GitHub</a></li>
                    <li><a href="https://twitter.com/reactphp"><i class="icon-twitter" aria-hidden="true"></i> Twitter</a></li>
                    <li><a href="https://gitter.im/reactphp/reactphp"><i class="icon-hash" aria-hidden="true"></i> Gitter</a></li>
                </ul>
            </div>
        </footer>
        </body>
</html>
